{"version":3,"sources":["../src/index.js"],"names":[],"mappings":"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","file":"curious-george.js","sourcesContent":["const GLOBAL = window;\nconst ERROR_MSG = {\n    INVALID_EMAIL : 'Invalid email address',\n    UNREACHABLE_API : 'API is unreachable',\n    UNKNOWN_PROVIDER : 'Unable to find CloudSponge provider',\n}\n\nconst DNS_MX_MAP = {\n    'gmail.com'               : 'gmail',\n    'aspmx.l.google.com'      : 'gmail',\n    'alt1.aspmx.l.google.com' : 'gmail',\n    'alt2.aspmx.l.google.com' : 'gmail',\n    'alt3.aspmx.l.google.com' : 'gmail',\n    'alt4.aspmx.l.google.com' : 'gmail',\n    'alt4.gmail-smtp-in.l.google.com' : 'gmail',\n    'alt3.gmail-smtp-in.l.google.com' : 'gmail',\n    'alt1.gmail-smtp-in.l.google.com' : 'gmail',\n    'gmail-smtp-in.l.google.com'      : 'gmail',\n    'alt2.gmail-smtp-in.l.google.com' : 'gmail',\n    \n    \n    'yahoo.com'              : 'yahoo',\n    'mx1.biz.mail.yahoo.com' : 'yahoo',    \n    'mx5.biz.mail.yahoo.com' : 'yahoo',\n    'mta5.am0.yahoodns.net'  : 'yahoo',\n    'mta6.am0.yahoodns.net'  : 'yahoo',\n    'mta7.am0.yahoodns.net'  : 'yahoo',\n    \n    'hotmail.com'     : 'windowslive',\n    'outlook.com'     : 'windowslive',\n    'mx1.hotmail.com' : 'windowslive',\n    'mx2.hotmail.com' : 'windowslive',\n    'mx3.hotmail.com' : 'windowslive',\n    'mx4.hotmail.com' : 'windowslive',\n    \n    'aol.com'              : 'aol',\n    'mailin-01.mx.aol.com' : 'aol',\n    'mailin-02.mx.aol.com' : 'aol',\n    'mailin-03.mx.aol.com' : 'aol',\n    'mailin-04.mx.aol.com' : 'aol',\n    \n    'icloud.com'          : 'icloud',\n    'mx1.mail.icloud.com' : 'icloud',\n    'mx2.mail.icloud.com' : 'icloud',\n    'mx3.mail.icloud.com' : 'icloud',\n    'mx4.mail.icloud.com' : 'icloud',\n    'mx5.mail.icloud.com' : 'icloud',\n    'mx6.mail.icloud.com' : 'icloud',\n    \n    'plaxo.com'      : 'plaxo',\n    'mail.plaxo.com' : 'plaxo',\n    'plaxo-com.mail.protection.outlook.com' : 'plaxo',\n    \n    'mail.ru'     : 'mail_ru',\n    'mxs.mail.ru' : 'mail_ru',\n    \n    'uol.com.br'       : 'uol',\n    'mx-p1.uol.com.br' : 'uol',\n    \n    'bol.com.br'              : 'bol',\n    'pro-mail-mx-001.bol.com' : 'bol',\n    'pro-mail-mx-002.bol.com' : 'bol',\n    \n    'terra.com.br' : 'terra',\n    'vip-mail-mx-gateway.terra.com' : 'terra',\n    \n    'rediff.com' : 'rediff',\n    'mx.rediffmail.rediff.akadns.net' : 'rediff',\n    \n    '126.com' : 'mail126',\n    '126mx00.mxmail.netease.com' : 'mail126',\n    '126mx01.mxmail.netease.com' : 'mail126',\n    '126mx02.mxmail.netease.com' : 'mail126',\n    \n    '163.com' : 'mail163',\n    '163mx00.mxmail.netease.com' : 'mail163',\n    '163mx01.mxmail.netease.com' : 'mail163',\n    '163mx02.mxmail.netease.com' : 'mail163',\n    '163mx03.mxmail.netease.com' : 'mail163',\n    \n    'yeah.net' : 'mail_yeah_net',\n    'yeahmx00.mxmail.netease.com' : 'mail_yeah_net',\n    'yeahmx01.mxmail.netease.com' : 'mail_yeah_net',\n    \n    'gmx.net' : 'gmx',\n    'mx00.emig.gmx.net' : 'gmx',\n    'mx01.emig.gmx.net' : 'gmx',\n    \n    'qip.ru'    : 'qip_ru',\n    'mx.qip.ru' : 'qip_ru',\n    \n    'sapo.pt' : 'sapo',\n    'mx.ptmail.sapo.pt' : 'sapo',\n    \n    'mail.com' : 'mail',\n    'mx00.mail.com' : 'mail',\n    'mx01.mail.com' : 'mail',\n    \n    'yandex.ru' : 'yandex_ru',\n    'mx.yandex.ru' : 'yandex_ru',\n}\n\nclass CuriousGeorge {\n    \n    lookup(email) {\n        let host = this.getHostName(email);\n        return new Promise((resolve, reject) => {\n            if (host) {\n                let id = CuriousGeorge.getId();                \n                GLOBAL[`CuriousGeorge__jsonp__${id}`] = (response) => {\n                    if (!response) {\n                        reject(ERROR_MSG.UNREACHABLE_API);\n                    }\n                    else {\n                        resolve(response);\n                    }\n                    CuriousGeorge.cleanup(id);\n                }\n                CuriousGeorge.injectScript(id, host);\n            }\n            else {\n                reject(ERROR_MSG.INVALID_EMAIL);\n            }\n        })\n    }\n    \n    findProvider(email) {\n        let host = this.getHostName(email);\n        return new Promise((resolve, reject) => {\n            if (DNS_MX_MAP[host]) {\n                resolve(DNS_MX_MAP[host]);\n            }\n            else {\n                this.lookup(email)\n                .then(response => {\n                    let answer = response.answer || [];\n\n                    for (let i = 0, len = answer.length; i < len; i++) {\n                        if (DNS_MX_MAP[answer[i].rdata[1]]) {\n                            resolve(DNS_MX_MAP[answer[i].rdata[1]]);\n                            return;\n                        }\n                    }\n\n                    reject(ERROR_MSG.UNKNOWN_PROVIDER);\n                })\n                .catch(err => {\n                    reject(err);\n                })\n            }\n        })\n    }\n    \n    getHostName(email) {\n        let match = /@(.+)$/.exec(email)\n        \n        if (match) {\n            return match[1];\n        }\n        return null\n    }\n    \n    static injectScript(id, host) {\n        let script = document.createElement('script');\n        let callback = `CuriousGeorge__jsonp__${id}`;\n        \n        script.id = `script_${id}`;\n        script.async = true;\n        script.onerror = GLOBAL[callback];\n        script.src = `http://dig.jsondns.org/IN/${host}/MX?callback=${callback}`\n        \n        document.head.appendChild(script);\n    }\n    \n    static cleanup(id) {\n        var script = document.getElementById(`script_${id}`);\n        \n        GLOBAL[`CuriousGeorge__jsonp__${id}`] = null;\n        script.parentNode.removeChild(script);\n    }\n    \n    static getId() {\n        if (!CuriousGeorge.__id__) {\n            CuriousGeorge.__id__ = 0;\n        }\n        return ++CuriousGeorge.__id__;\n    }\n}\n\n"]}